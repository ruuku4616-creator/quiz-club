<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クイズ研究会</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <nav>
        <a href="#" class="logo-area">
            <img id="site-logo-img" src="" alt="ロゴ" style="display: none; height: 50px; width: auto; margin-right: 10px;">
            <div id="logo-q-placeholder" class="logo-placeholder">Q</div>
            <span id="site-logo-text">Shibaura Institute of Quiz</span>
        </a>
    </nav>

    <header>
        <h1 id="main-title">読み込み中...</h1>
        <p id="sub-title">読み込み中...</p>
    </header>

    <div class="container">
        <div class="section">
            <h2>活動紹介</h2>
            <p id="intro-content">読み込み中...</p>
            <a href="/admin/" style="color: var(--accent-green); text-decoration: none; border: 1px solid var(--accent-green); padding: 5px 10px; border-radius: 5px; font-size: 0.8rem;">管理者ログイン</a>
        </div>
<section>
    <h2>活動報告</h2>
    <ul id="blog-list">
        <li>読み込み中...</li>
    </ul>
</section>

</div> <script>
        async function loadSiteData() {
            try {
                const response = await fetch('data/index.json');
                const data = await response.json();
                
                // タイトル類の反映
                document.getElementById('main-title').innerText = data.site_title || "クイズ研究会";
                document.getElementById('sub-title').innerText = data.site_subtitle || "";
                document.getElementById('intro-content').innerText = data.intro_text || "";
                document.getElementById('site-logo-text').innerText = data.site_title || "Shibaura Institute of Quiz";
                
                // 【重要】ロゴ画像の復活処理
                const logoImg = document.getElementById('site-logo-img');
                const logoPlaceholder = document.getElementById('logo-q-placeholder');
                if (data.logo_image) {
                    logoImg.src = data.logo_image;
                    logoImg.style.display = 'block';
                    if(logoPlaceholder) logoPlaceholder.style.display = 'none';
                }
            } catch (e) { console.error(e); }
        }

        async function loadBlogPosts() {
            const repo = "ruuku4616-creator/quiz_club"; // あなたのリポジトリ名
            const folder = "data/blog";
            const listElement = document.getElementById('blog-list');
            try {
        // GitHubのAPIを使って、フォルダ内のファイル一覧を直接取得する
                const response = await fetch(`https://api.github.com/repos/${repo}/contents/${folder}`);
            if (!response.ok) throw new Error('一覧の取得に失敗しました');
                const files = await response.json();
        listElement.innerHTML = '';

        // ファイル名で並び替え（新しい日付が上にくるように降順にする）
        files.sort((a, b) => b.name.localeCompare(a.name));

        files.forEach(file => {
            // .md ファイルだけを表示対象にする
            if (file.name.endsWith('.md')) {
                // 拡張子(.md)を消した名前をタイトルとして使用
                const postName = file.name.replace('.md', '');
                
                const li = document.createElement('li');
                // リンク先は blog.html。ファイル名をパラメータとして渡す
                li.innerHTML = `<a href="blog.html?post=${postName}" style="color: inherit; text-decoration: underline;">${postName}</a>`;
                listElement.appendChild(li);
            }
        });

        if (listElement.innerHTML === '') {
            listElement.innerHTML = '<li>現在、活動報告はありません。</li>';
        }

    } catch (error) {
        console.error('自動読み込みエラー:', error);
        listElement.innerHTML = '<li>活動報告を読み込めませんでした。</li>';
    }
}
        window.addEventListener('DOMContentLoaded', () => {
            loadSiteData();
            loadBlogPosts();
        });
    </script>


