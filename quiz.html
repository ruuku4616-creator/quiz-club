<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クイズ閲覧 - クイズ研究会</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <a href="index.html" class="logo-area">
            <span id="site-logo-text">Shibaura Institute of Quiz</span>
        </a>
    </nav>

    <div class="container" style="margin-top: 80px;">
        <h1 style="color: var(--accent-green);">クイズアーカイブ</h1>
        <p>過去に出題された問題に挑戦してみよう！</p>

        <div id="quiz-container">
            <p>読み込み中...</p>
        </div>

        <a href="index.html" style="color: var(--accent-green); text-decoration: none;">← トップページへ戻る</a>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        async function loadAllQuizzes() {
            const container = document.getElementById('quiz-container');
            try {
                const response = await fetch('data/quiz-list.json');
                const quizFiles = await response.json();
                
                container.innerHTML = ''; // 読み込み中を消す

                for (const fileName of quizFiles) {
                    const res = await fetch(`data/quiz/${fileName}.md`);
                    const text = await res.text();
                    
                    const parts = text.split('---');
                    if (parts.length >= 3) {
                        // 2番目の---の後が問題、3番目の---の後が答え
                        const question = marked.parse(parts[2].trim());
                        const answer = marked.parse(parts[3] ? parts[3].trim() : "回答が設定されていません");
                        
                        const section = document.createElement('div');
                        section.className = 'section';
                        section.innerHTML = `
                            <div class="quiz-box" onclick="toggleAnswer(this)">
                                <div>${question}</div>
                                <div class="answer">${answer}</div>
                            </div>
                        `;
                        container.appendChild(section);
                    }
                }
            } catch (e) {
                console.error(e);
                container.innerHTML = '<p>クイズを読み込めませんでした。管理画面からクイズを投稿してください。</p>';
            }
        }

        function toggleAnswer(element) {
            const answer = element.querySelector('.answer');
            answer.style.display = (answer.style.display === 'block') ? 'none' : 'block';
        }

        window.addEventListener('DOMContentLoaded', loadAllQuizzes);
    </script>
</body>
</html>
